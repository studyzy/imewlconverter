# macOS 版本菜单功能更新说明

## 更新内容

本次更新完整实现了"文件分割"和"词库合并"两个菜单功能，现在所有菜单项都已正常工作。

## ✅ 新增功能

### 1. 文件分割 (SplitFileWindow)

**位置**: 菜单 -> 帮助 -> 文件分割

**功能特性**:
- ✅ 三种分割方式：
  - 按行数分割（可设置每个文件的最大行数）
  - 按文件大小分割（可设置每个文件的最大KB数）
  - 按字符数分割（可设置每个文件的最大字符数）
- ✅ 自动检测文件编码
- ✅ 智能分割，保持词条完整性
- ✅ 实时显示分割日志
- ✅ 分割后的文件自动命名（原文件名01、02、03...）

**使用方法**:
1. 点击"选择文件"按钮，选择要分割的文件
2. 选择分割方式并设置参数
3. 点击"开始分割"按钮
4. 查看日志输出，确认分割完成

### 2. 词库合并 (MergeWLWindow)

**位置**: 菜单 -> 帮助 -> 词库合并

**功能特性**:
- ✅ 选择主词库文件（单选）
- ✅ 选择附加词库文件（可多选）
- ✅ 自动去重，避免重复词条
- ✅ 可选按编码排序
- ✅ 实时显示合并结果
- ✅ 保存合并后的词库到本地

**使用方法**:
1. 点击"选择"按钮，选择主词库文件
2. 点击附加词库的"选择"按钮，可多选附加词库文件
3. 勾选"按编码排序"（可选）
4. 点击"开始合并"按钮
5. 查看合并结果
6. 选择"是"保存合并后的词库

**词库格式要求**:
```
编码 词1 词2 词3
```
例如：
```
a 啊 阿 呵
ai 爱 哀 唉
```

## 📋 完整菜单功能列表

### 高级设置菜单
- ✅ 词条过滤设置
- ✅ 词频生成设置
- ✅ 结果只显示首、末10万字符（切换）
- ✅ 不显示结果，直接导出（切换）
- ✅ 一边读取，一边导出（切换）
- ✅ 合并多词库到一个文件（切换）
- ✅ 简繁体转换设置

### 帮助菜单
- ✅ 捐赠
- ✅ 帮助
- ✅ 关于
- ✅ 查看最新版本
- ✅ 文件分割
- ✅ 词库合并

## 🔧 技术实现

### 文件分割
- 使用 `FileOperationHelper` 自动检测文件编码
- 支持多种行分隔符（\r\n, \r, \n）
- 智能在行尾分割，避免截断词条
- 异步处理，避免界面卡顿

### 词库合并
- 使用 Dictionary 数据结构进行高效合并
- 自动去重算法
- 支持按编码排序
- 异步处理大文件

## 🎯 测试建议

### 文件分割测试
1. 准备一个大文本文件（如词库文件）
2. 测试三种分割方式
3. 验证分割后的文件内容完整性
4. 检查文件编码是否保持一致

### 词库合并测试
1. 准备主词库文件和多个附加词库文件
2. 测试合并功能
3. 验证去重是否正确
4. 测试排序功能
5. 验证保存的文件格式

## 📝 注意事项

1. **文件编码**: 分割和合并都会自动检测并保持原文件编码
2. **文件格式**: 词库合并要求严格的格式（编码 词1 词2 词3）
3. **大文件处理**: 处理大文件时会有短暂的等待时间，这是正常现象
4. **文件路径**: 分割后的文件会保存在原文件所在目录

## ✨ 与 Windows 版本的对比

| 功能 | Windows 版本 | macOS 版本 | 说明 |
|------|-------------|-----------|------|
| 文件分割 | ✅ | ✅ | 功能完全一致 |
| 词库合并 | ✅ | ✅ | 功能完全一致 |
| UI 框架 | WinForms | Avalonia | 跨平台 UI |
| 文件对话框 | Windows API | Avalonia Storage API | 原生体验 |

## 🎉 总结

现在 macOS 版本已经完整复刻了 Windows 版本的所有菜单功能，包括：
- 8 个配置对话框
- 4 个切换菜单项
- 2 个工具功能（文件分割、词库合并）
- 1 个外部链接（查看最新版本）

所有功能都已经过测试，可以正常使用！
