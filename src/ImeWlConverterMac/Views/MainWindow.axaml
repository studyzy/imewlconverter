<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:ImeWlConverterMac.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
        x:Class="ImeWlConverterMac.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"

        Title="深蓝词库转换"
        Width="800" Height="650"
        MinWidth="600" MinHeight="500"
        WindowStartupLocation="CenterScreen">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 主要内容区域 -->
        <Grid Grid.Row="0" Margin="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- 文件选择区域 -->
            <Grid Grid.Row="0" Margin="0,0,0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBox Grid.Column="0" 
                         Text="{Binding FilePath}" 
                         Watermark="请选择源词库文件或拖拽文件到此处"
                         IsReadOnly="True"
                         Height="32"
                         VerticalContentAlignment="Center"/>
                <Button Grid.Column="1" 
                        Content="..." 
                        Width="50" 
                        Height="32"
                        Margin="5,0,0,0"
                        Command="{Binding OpenFileCommand}"/>
                <Button Grid.Column="2" 
                        Content="转 换" 
                        Width="100" 
                        Height="64"
                        Margin="10,0,0,0"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Command="{Binding ConvertCommand}"
                        Grid.RowSpan="2"/>
            </Grid>

            <!-- 转换类型选择区域 -->
            <Grid Grid.Row="1" Margin="0,0,0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" MinWidth="200"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*" MinWidth="200"/>
                    <ColumnDefinition Width="110"/>
                </Grid.ColumnDefinitions>

                <ComboBox Grid.Column="0" 
                          ItemsSource="{Binding ImportTypes}"
                          SelectedItem="{Binding SelectedImportType}"
                          PlaceholderText="选择源词库类型"
                          Height="32"
                          HorizontalAlignment="Stretch"/>
                <TextBlock Grid.Column="1" 
                           Text="-->>" 
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"
                           FontSize="14"
                           Margin="15,0"/>
                <ComboBox Grid.Column="2" 
                          ItemsSource="{Binding ExportTypes}"
                          SelectedItem="{Binding SelectedExportType}"
                          PlaceholderText="选择目标词库类型"
                          Height="32"
                          HorizontalAlignment="Stretch"/>
            </Grid>

            <!-- 进度条 -->
            <ProgressBar Grid.Row="2" 
                         Value="{Binding Progress}" 
                         Maximum="100"
                         IsVisible="{Binding IsConverting}"
                         Margin="0,0,0,10"/>

            <!-- 结果显示区域 -->
            <ScrollViewer Grid.Row="3">
                <TextBox Text="{Binding ResultText}" 
                         IsReadOnly="True"
                         AcceptsReturn="True"
                         TextWrapping="Wrap"
                         FontFamily="Consolas,Monaco,Courier New,monospace"
                         FontSize="12"/>
            </ScrollViewer>
        </Grid>

        <!-- 状态栏 -->
        <Border Grid.Row="1" 
                Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}"
                BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                BorderThickness="0,1,0,0">
            <Grid Height="28">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" 
                           Text="{Binding StatusMessage}" 
                           VerticalAlignment="Center"
                           Margin="10,0"/>
                <ProgressBar Grid.Column="1" 
                             Width="150" 
                             Height="16"
                             Value="{Binding Progress}"
                             Maximum="100"
                             IsVisible="{Binding IsConverting}"
                             Margin="0,0,10,0"/>
            </Grid>
        </Border>
    </Grid>
</Window>